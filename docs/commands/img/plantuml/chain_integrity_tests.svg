<svg contentStyleType="text/css" height="1565" preserveAspectRatio="none" viewBox="0 0 869 1565" width="869" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify"><g fill="none" stroke="#000" stroke-width="1.5"><path d="m20 201.7305h480.5v180.8633h-480.5z"/><path d="m30 255.3516h460.5v120.2422h-460.5z"/><path d="m40 321.9727h440.5v46.6211h-440.5z"/><path d="m10 497.5254h853.5v969.0059h-853.5z"/><path d="m20 609.7676h668.5v344.416h-668.5z"/><path d="m30 705.6992h648.5v167.8633h-648.5z"/><path d="m40 788.6309h440.5v77.9316h-440.5z"/><path d="m30 1010.4941h823.5v406.7266h-823.5z"/><path d="m40 1135.7363h708.5v202.8633h-708.5z"/></g><g stroke="#181818"><path d="m131 67.4883v1416.043" stroke-dasharray="5 5" stroke-width=".5"/><path d="m439.5 67.4883v1416.043" stroke-dasharray="5 5" stroke-width=".5"/><path d="m528.5 67.4883v1416.043" stroke-dasharray="5 5" stroke-width=".5"/><path d="m627.5 67.4883v1416.043" stroke-dasharray="5 5" stroke-width=".5"/><path d="m708.5 67.4883v1416.043" stroke-dasharray="5 5" stroke-width=".5"/><path d="m795.5 67.4883v1416.043" stroke-dasharray="5 5" stroke-width=".5"/><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke-width=".5" width="163" x="50" y="36"/></g><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="57" y="56.5352">ChainIntegrity Service</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="163" x="50" y="1482.5313"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="57" y="1503.0664">ChainIntegrity Service</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="62" x="408.5" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="415.5" y="56.5352">Logger</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="62" x="408.5" y="1482.5313"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="415.5" y="1503.0664">Logger</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="480.5" y="64.5352">BlockchainDB</text><path d="m511 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m511 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="480.5" y="1496.0664">BlockchainDB</text><path d="m511 1509.0195c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m511 1509.0195c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="587.5" y="64.5352">UTXOStore</text><path d="m610 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m610 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="587.5" y="1496.0664">UTXOStore</text><path d="m610 1509.0195c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m610 1509.0195c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="678.5" y="64.5352">TXStore</text><path d="m690.5 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m690.5 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="678.5" y="1496.0664">TXStore</text><path d="m690.5 1509.0195c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m690.5 1509.0195c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="748.5" y="64.5352">SubtreeStore</text><path d="m778 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m778 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="748.5" y="1496.0664">SubtreeStore</text><path d="m778 1509.0195c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m778 1509.0195c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><path d="m517 94.7988 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 98.7988h391.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="138.5" y="94.0566">GetBestBlockHeader()</text><path d="m142.5 124.1094-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m136.5 128.1094h391.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="148.5" y="123.3672">Return bestBlockHeader</text><path d="m517 153.4199 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 157.4199h391.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319" x="138.5" y="152.6777">GetBlockHeaders(bestBlockHeader.Hash(), 100000)</text><path d="m142.5 182.7305-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m136.5 186.7305h391.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="148.5" y="181.9883">Return blockHeaders</text><path d="m20 201.7305h74v7.3105l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m20 201.7305h480.5v180.8633h-480.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="35" y="215.2988">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="223" x="109" y="214.3652">[for each blockHeader in blockHeaders]</text><path d="m427.5 236.3516 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 240.3516h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="138.5" y="235.6094">Log checking block header</text><path d="m30 255.3516h62v7.3105l-10 10h-52z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m30 255.3516h460.5v120.2422h-460.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="45" y="268.9199">alt</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="163" x="107" y="267.9863">[previousBlockHeader exists]</text><path d="m131.5 293.9727h42" stroke="#181818"/><path d="m173.5 293.9727v13" stroke="#181818"/><path d="m132.5 306.9727h41" stroke="#181818"/><path d="m142.5 302.9727-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="138.5" y="289.2305">Verify HashPrevBlock == previousBlock's Hash</text><path d="m40 321.9727h62v7.3105l-10 10h-52z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m40 321.9727h440.5v46.6211h-440.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="55" y="335.541">alt</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="126" x="117" y="334.6074">[Hashes do not match]</text><path d="m427.5 356.5938 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 360.5938h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="138.5" y="355.8516">Log error</text><path d="m427.5 406.9043 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 410.9043h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="138.5" y="406.1621">Log block headers are valid</text><path d="m131.5 440.2148h42" stroke="#181818"/><path d="m173.5 440.2148v13" stroke="#181818"/><path d="m132.5 453.2148h41" stroke="#181818"/><path d="m142.5 449.2148-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="138.5" y="435.4727">Initialize transactionMap</text><path d="m427.5 478.5254 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 482.5254h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="138.5" y="477.7832">Log checking blocks/subtrees</text><path d="m10 497.5254h74v7.3105l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 497.5254h853.5v969.0059h-853.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="25" y="511.0938">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="222" x="99" y="510.1602">[for each blockHeader in reverse order]</text><path d="m517 532.1465 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 536.1465h391.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="138.5" y="531.4043">GetBlock(blockHeader.Hash())</text><path d="m142.5 561.457-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m136.5 565.457h391.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="148.5" y="560.7148">Return block, height</text><path d="m427.5 590.7676 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 594.7676h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="138.5" y="590.0254">Log checking block</text><path d="m20 609.7676h62v7.3105l-10 10h-52z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m20 609.7676h668.5v344.416h-668.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="35" y="623.3359">alt</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="153" x="97" y="622.4023">[block.CoinbaseTx is valid]</text><path d="m427.5 644.3887 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 648.3887h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="138.5" y="643.6465">Log valid coinbase transaction</text><path d="m131.5 677.6992h42" stroke="#181818"/><path d="m173.5 677.6992v13" stroke="#181818"/><path d="m132.5 690.6992h41" stroke="#181818"/><path d="m142.5 686.6992-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="138.5" y="672.957">Check coinbase UTXOs creation</text><path d="m30 705.6992h74v7.3106l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m30 705.6992h648.5v167.8633h-648.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="45" y="719.2676">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="178" x="119" y="718.334">[for each output in CoinbaseTx]</text><path d="m616 740.3203 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 744.3203h490.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="138.5" y="739.5781">Get(coinbaseTxID, vout)</text><path d="m142.5 769.6309-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m136.5 773.6309h490.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="148.5" y="768.8887">Return UTXO details</text><path d="m40 788.6309h62v7.3105l-10 10h-52z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m40 788.6309h440.5v77.9316h-440.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="55" y="802.1992">alt</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="117" y="801.2656">[UTXO not found]</text><path d="m427.5 823.252 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 827.252h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="138.5" y="822.5098">Log UTXO does not exist</text><path d="m40 836.252h440.5" stroke="#000" stroke-dasharray="2 2"/><path d="m427.5 854.5625 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 858.5625h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="138.5" y="853.8203">Log UTXO exists</text><path d="m131.5 901.873h42" stroke="#181818"/><path d="m173.5 901.873v13" stroke="#181818"/><path d="m132.5 914.873h41" stroke="#181818"/><path d="m142.5 910.873-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="138.5" y="897.1309">Extract and validate coinbase height</text><path d="m20 923.873h668.5" stroke="#000" stroke-dasharray="2 2"/><path d="m427.5 942.1836 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 946.1836h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="138.5" y="941.4414">Log invalid coinbase transaction</text><path d="m131.5 982.4941h42" stroke="#181818"/><path d="m173.5 982.4941v13" stroke="#181818"/><path d="m132.5 995.4941h41" stroke="#181818"/><path d="m142.5 991.4941-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="138.5" y="977.752">Add coinbase to transactionMap</text><path d="m30 1010.4941h74v7.3106l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m30 1010.4941h823.5v406.7266h-823.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="45" y="1024.0625">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="227" x="119" y="1023.1289">[for each subtreeHash in block.Subtrees]</text><path d="m784 1045.1152 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 1049.1152h658.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="138.5" y="1044.373">Get(subtreeHash)</text><path d="m142.5 1074.4258-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m136.5 1078.4258h658.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="148.5" y="1073.6836">Return subtreeBytes</text><path d="m131.5 1107.7363h42" stroke="#181818"/><path d="m173.5 1107.7363v13" stroke="#181818"/><path d="m132.5 1120.7363h41" stroke="#181818"/><path d="m142.5 1116.7363-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="138.5" y="1102.9941">Parse subtreeBytes into subtree</text><path d="m40 1135.7363h74v7.3106l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m40 1135.7363h708.5v202.8633h-708.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="55" y="1149.3047">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="182" x="129" y="1148.3711">[for each node in subtree.Nodes]</text><path d="m131.5 1174.3574h42" stroke="#181818"/><path d="m173.5 1174.3574v13" stroke="#181818"/><path d="m132.5 1187.3574h41" stroke="#181818"/><path d="m142.5 1183.3574-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="138.5" y="1169.6152">Check transaction existence and validation</text><path d="m696.5 1212.668 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 1216.668h571" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="138.5" y="1211.9258">Get(node.Hash)</text><path d="m142.5 1241.9785-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m136.5 1245.9785h571" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="148.5" y="1241.2363">Return txBytes</text><path d="m131.5 1275.2891h42" stroke="#181818"/><path d="m173.5 1275.2891v13" stroke="#181818"/><path d="m132.5 1288.2891h41" stroke="#181818"/><path d="m142.5 1284.2891-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="138.5" y="1270.5469">Parse txBytes into btTx</text><path d="m131.5 1317.5996h42" stroke="#181818"/><path d="m173.5 1317.5996v13" stroke="#181818"/><path d="m132.5 1330.5996h41" stroke="#181818"/><path d="m142.5 1326.5996-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="138.5" y="1312.8574">Validate inputs and outputs of btTx</text><path d="m427.5 1362.9102 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m131.5 1366.9102h302" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="138.5" y="1362.168">Log subtree transactions and fees</text><path d="m131.5 1396.2207h42" stroke="#181818"/><path d="m173.5 1396.2207v13" stroke="#181818"/><path d="m132.5 1409.2207h41" stroke="#181818"/><path d="m142.5 1405.2207-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="138.5" y="1391.4785">Check if subtreeFees match subtree.Fees</text><path d="m131.5 1445.5313h42" stroke="#181818"/><path d="m173.5 1445.5313v13" stroke="#181818"/><path d="m132.5 1458.5313h41" stroke="#181818"/><path d="m142.5 1454.5313-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="138.5" y="1440.7891">Calculate and validate block fees</text><text fill="#888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="351" x="3" y="1555.6875">Last Modified On: 15-April-2024. © 2024 Bitcoin SV. All rights reserved.</text></svg>
