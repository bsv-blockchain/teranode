@startuml Worker Init and Start Function
skinparam backgroundColor #F0F8FF
skinparam defaultFontColor #333333
skinparam arrowColor #666666

' Define borders for all elements
skinparam entity {
  BorderColor #666666
  BackgroundColor #DDDDDD
}

skinparam control {
  BorderColor #666666
  BackgroundColor #DDDDDD
}

skinparam participant {
  BorderColor #666666
  BackgroundColor #DDDDDD
}



participant "Worker" as Worker
participant "Coinbase\nService" as Coinbase
participant "Propagation\nService" as Propagation

== Worker Initialization (Init) ==
Worker -> Coinbase : Request initial funds
Coinbase -> Worker : Provide TX out of existing spendable UTXOs
Worker -> Propagation : Send TX to the propagation service
Propagation --> Worker : OK, error

loop For each UTXO output in the sent Tx
    Worker -> Worker : Add UTXO to queue for Tx processing
end

== Transaction Processing ==
loop Transaction Processing Loop
    Worker -> Worker : Generate new transaction from UTXO
    alt Successful Transaction Generation
        Worker -> Propagation : Send transaction
        Propagation --> Worker : OK, error

        loop For each UTXO output in the sent Tx
            Worker -> Worker : Add UTXO to queue for Tx processing
        end

    else Error in Transaction Generation
        Worker -> Worker : Log error
    end

    alt Rate Limiting Enabled
        Worker -> Worker : Wait based on rate limit
    end
end

== Shutdown ==
alt Graceful Shutdown Triggered
    Worker -> Worker : Stop processing new transactions

end

left footer Last Modified On: %date("dd-MMM-yyyy")

@enduml
