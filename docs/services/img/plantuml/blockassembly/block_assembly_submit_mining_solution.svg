<svg contentStyleType="text/css" height="1088" preserveAspectRatio="none" viewBox="0 0 2204 1088" width="2204" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify"><path d="m281.5 141.1094h10v850.6953h-10z" fill="#fff" stroke="#181818"/><path d="m537.5 170.4199h10v792.0742h-10z" fill="#fff" stroke="#181818"/><path d="m966 258.3516h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m1029 359.2832h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m1084 726.0098h10v58.6211h-10z" fill="#fff" stroke="#181818"/><path d="m1263.5 417.9043h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m1539 476.5254h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m1680.5 593.7676h10v102.9316h-10z" fill="#fff" stroke="#181818"/><path d="m2117.5 535.1465h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m2117.5 896.873h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m1626 608.7676h496.5v59.6211h-496.5z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m449.5 858.252h1748.5v75.9316h-1748.5z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m35 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m286 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m542.5 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m854 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m971 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1034 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1089 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1268 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1544 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1685 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m2122 67.4883v942.3164" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="61" x="5" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="12" y="56.5352">Mining</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="61" x="5" y="1008.8047"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="12" y="1029.3398">Mining</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="163" x="205" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="212" y="56.5352">Block Assembly Client</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="163" x="205" y="1008.8047"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="212" y="1029.3398">Block Assembly Client</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="166" x="459.5" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="466.5" y="56.5352">Block Assembly Server</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="166" x="459.5" y="1008.8047"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="466.5" y="1029.3398">Block Assembly Server</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="149" x="780" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="787" y="56.5352">blockSubmissionCh</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="149" x="780" y="1008.8047"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="787" y="1029.3398">blockSubmissionCh</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="939" y="64.5352">JobStore</text><path d="m953 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m953 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="939" y="1022.3398">JobStore</text><path d="m953 1035.293c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m953 1035.293c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="1013" y="64.5352">Block</text><ellipse cx="1034" cy="35" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m1022 49h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="1013" y="1022.3398">Block</text><ellipse cx="1034" cy="1041.293" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m1022 1055.293h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1065" y="64.5352">Model</text><ellipse cx="1089" cy="35" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m1077 49h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1065" y="1022.3398">Model</text><ellipse cx="1089" cy="1041.293" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m1077 1055.293h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="1205" y="64.5352">Transaction Store</text><path d="m1250.5 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1250.5 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="1205" y="1022.3398">Transaction Store</text><path d="m1250.5 1035.293c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1250.5 1035.293c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="1462" y="64.5352">Transaction Meta Store</text><path d="m1526 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1526 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="1462" y="1022.3398">Transaction Meta Store</text><path d="m1526 1035.293c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1526 1035.293c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="1636" y="64.5352">Subtree Store</text><path d="m1667.5 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1667.5 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="1636" y="1022.3398">Subtree Store</text><path d="m1667.5 1035.293c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1667.5 1035.293c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="131" x="2057" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="2064" y="56.5352">Blockchain Client</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="131" x="2057" y="1008.8047"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="2064" y="1029.3398">Blockchain Client</text><g stroke="#181818"><path d="m281.5 141.1094h10v850.6953h-10z" fill="#fff"/><path d="m537.5 170.4199h10v792.0742h-10z" fill="#fff"/><path d="m966 258.3516h10v29.3105h-10z" fill="#fff"/><path d="m1029 359.2832h10v29.3105h-10z" fill="#fff"/><path d="m1084 726.0098h10v58.6211h-10z" fill="#fff"/><path d="m1263.5 417.9043h10v29.3105h-10z" fill="#fff"/><path d="m1539 476.5254h10v29.3105h-10z" fill="#fff"/><path d="m1680.5 593.7676h10v102.9316h-10z" fill="#fff"/><path d="m2117.5 535.1465h10v29.3105h-10z" fill="#fff"/><path d="m2117.5 896.873h10v29.3105h-10z" fill="#fff"/><path d="m35.5 98.7988h42"/><path d="m77.5 98.7988v13"/><path d="m36.5 111.7988h41"/><path d="m46.5 107.7988-10 4 10 4-4-4z" fill="#181818"/></g><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="42.5" y="94.0566">Solve the mining challenge</text><path d="m269.5 137.1094 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m35.5 141.1094h240" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="42.5" y="136.3672">SubmitMiningSolution(ctx, solution)</text><path d="m525.5 166.4199 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m291.5 170.4199h240" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="298.5" y="165.6777">SubmitMiningSolution(ctx, solution)</text><path d="m842.5 195.7305 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 199.7305h301" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="554.5" y="194.9883">Add block submission</text><path d="m558.5 225.041-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 229.041h301" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283" x="564.5" y="224.2988">submitMiningSolution(ctx, blockSubmission)</text><path d="m954 254.3516 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 258.3516h412.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="554.5" y="253.6094">jobItem = Get(*storeId)</text><path d="m558.5 283.6621-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 287.6621h417.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="564.5" y="282.9199">return jobItem</text><path d="m547.5 316.9727h42" stroke="#181818"/><path d="m589.5 316.9727v13" stroke="#181818"/><path d="m548.5 329.9727h41" stroke="#181818"/><path d="m558.5 325.9727-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="554.5" y="312.2305">Create new block with proof of work</text><path d="m1017 355.2832 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 359.2832h475.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="554.5" y="354.541">block.Valid(cntxt, nil, nil, nil)</text><path d="m558.5 384.5938-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 388.5938h480.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="564.5" y="383.8516">Validation result</text><path d="m1251.5 413.9043 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 417.9043h710" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="697" x="554.5" y="413.1621">Set(context.Background(), block.CoinbaseTx.TxIDChainHash().CloneBytes(), block.CoinbaseTx.ExtendedBytes())</text><path d="m558.5 443.2148-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 447.2148h715" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="564.5" y="442.4727">Coinbase Transaction stored</text><path d="m1527 472.5254 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 476.5254h985.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="554.5" y="471.7832">Create(cntxt, block.CoinbaseTx)</text><path d="m558.5 501.8359-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 505.8359h990.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="564.5" y="501.0938">Coinbase Metadata stored</text><path d="m2105.5 531.1465 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 535.1465h1564" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="554.5" y="530.4043">AddBlock(cntxt, block, "")</text><path d="m558.5 560.457-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 564.457h1569" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="564.5" y="559.7148">Block added to the local Blockchain</text><path d="m1668.5 589.7676 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 593.7676h1127" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="554.5" y="589.0254">removeSubtreesTTL(gCtx, block)</text><path d="m1626 608.7676h74v7.3105l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m1626 608.7676h496.5v59.6211h-496.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="1641" y="622.3359">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99" x="1715" y="621.4023">[for each subtree]</text><path d="m1690.5 647.3887h42" stroke="#181818"/><path d="m1732.5 647.3887v13" stroke="#181818"/><path d="m1691.5 660.3887h41" stroke="#181818"/><path d="m1701.5 656.3887-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="413" x="1697.5" y="642.6465">SetTTL(setCtx, subtreeHashBytes, 0) # 0 means delete the subtree</text><path d="m558.5 692.6992-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 696.6992h1132" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="564.5" y="691.957">Subtrees TTL updated</text><path d="m1072 722.0098 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 726.0098h530.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="491" x="554.5" y="721.2676">UpdateTxMinedStatus(gCtx, logger, txMetaStore, subtreesInJob, block.Header)</text><path d="m1532 751.3203 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m1094 755.3203h444" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="1101" y="750.5781">SetMinedMulti(gCtx, hashes, blockID)</text><path d="m1532 780.6309 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m1089 784.6309h449" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="1096" y="779.8887">TX Status updated as mined (for all Txs in all Subtrees)</text><path d="m959 809.9414 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 813.9414h417.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="554.5" y="809.1992">DeleteAll()</text><path d="m558.5 839.252-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 843.252h417.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="564.5" y="838.5098">All jobs deleted</text><path d="m449.5 858.252h62v7.3105l-10 10h-52z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m449.5 858.252h1748.5v75.9316h-1748.5z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="464.5" y="871.8203">alt</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93" x="526.5" y="870.8867">[If Error Occurs]</text><path d="m2105.5 892.873 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m547.5 896.873h1564" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279" x="554.5" y="892.1309">InvalidateBlock(setCtx, block.Header.Hash())</text><path d="m558.5 922.1836-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m552.5 926.1836h1569" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="564.5" y="921.4414">Block invalidated</text><path d="m302.5 958.4941-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m296.5 962.4941h245" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="308.5" y="957.752">Return result</text><path d="m46.5 987.8047-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m40.5 991.8047h245" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="52.5" y="987.0625">Return result</text></svg>
