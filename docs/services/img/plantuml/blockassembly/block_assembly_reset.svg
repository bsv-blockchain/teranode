<svg contentStyleType="text/css" height="498" preserveAspectRatio="none" viewBox="0 0 822 498" width="822" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify"><g stroke="#181818"><path d="m28 81.4883v335.7949" stroke-dasharray="5 5" stroke-width=".5"/><path d="m209 81.4883v335.7949" stroke-dasharray="5 5" stroke-width=".5"/><path d="m583 81.4883v335.7949" stroke-dasharray="5 5" stroke-width=".5"/><path d="m756 81.4883v335.7949" stroke-dasharray="5 5" stroke-width=".5"/></g><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="5" y="78.5352">Client</text><ellipse cx="28" cy="13.5" fill="#e2e2f0" rx="8" ry="8" stroke="#181818" stroke-width=".5"/><path d="m28 21.5v27m-13-19h26m-13 19-13 15m13-15 13 15" fill="none" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="5" y="429.8184">Client</text><ellipse cx="28" cy="441.2715" fill="#e2e2f0" rx="8" ry="8" stroke="#181818" stroke-width=".5"/><path d="m28 449.2715v27m-13-19h26m-13 19-13 15m13-15 13 15" fill="none" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="150" y="78.5352">Block Assembler</text><ellipse cx="209" cy="49" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m197 63h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="150" y="429.8184">Block Assembler</text><ellipse cx="209" cy="448.7715" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m197 462.7715h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="485" y="78.5352">Blockchain BlockchainClient</text><ellipse cx="583" cy="49" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m571 63h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="485" y="429.8184">Blockchain BlockchainClient</text><ellipse cx="583" cy="448.7715" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m571 462.7715h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="691" y="78.5352">Subtree Processor</text><ellipse cx="756" cy="49" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m744 63h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="691" y="429.8184">Subtree Processor</text><ellipse cx="756" cy="448.7715" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m744 462.7715h24" stroke="#181818" stroke-width=".5"/><path d="m197 108.7988 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m28 112.7988h175" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="35" y="108.0566">Call ResetBlockAssembly</text><path d="m571 138.1094 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m209 142.1094h368" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="216" y="137.3672">GetBestBlockHeader()</text><path d="m220 167.4199-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m214 171.4199h368" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="226" y="166.6777">Return bestBlockHeader, meta, err</text><path d="m209 200.7305h42" stroke="#181818"/><path d="m251 200.7305v13" stroke="#181818"/><path d="m210 213.7305h41" stroke="#181818"/><path d="m220 209.7305-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360" x="216" y="195.9883">Calculate reorg blocks(moveDownBlocks, moveUpBlocks)</text><path d="m744 239.041 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m209 243.041h541" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="216" y="238.2988">Reset subtree with new blocks</text><path d="m220 268.3516-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m214 272.3516h541" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="226" y="267.6094">Return response (with errors if any)</text><path d="m209 301.6621h42" stroke="#181818"/><path d="m251 301.6621v13" stroke="#181818"/><path d="m210 314.6621h41" stroke="#181818"/><path d="m220 310.6621-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="216" y="296.9199">Update internal state with new block header</text><path d="m209 343.9727h42" stroke="#181818"/><path d="m251 343.9727v13" stroke="#181818"/><path d="m210 356.9727h41" stroke="#181818"/><path d="m220 352.9727-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="216" y="339.2305">Update block height</text><path d="m209 386.2832h42" stroke="#181818"/><path d="m251 386.2832v13" stroke="#181818"/><path d="m210 399.2832h41" stroke="#181818"/><path d="m220 395.2832-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="216" y="381.541">Set current chain</text></svg>
