<svg contentStyleType="text/css" height="1197" preserveAspectRatio="none" viewBox="0 0 1127 1197" width="1127" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify"><path d="m53 106.7988h10v990.0742h-10z" fill="#fff" stroke="#181818"/><path d="m58 251.041h10v63.6211h-10z" fill="#fff" stroke="#181818"/><path d="m58 480.9043h10v102.9316h-10z" fill="#fff" stroke="#181818"/><path d="m58 656.457h10v63.6211h-10z" fill="#fff" stroke="#181818"/><path d="m804.5 480.9043h10v102.9316h-10z" fill="#fff" stroke="#181818"/><path d="m804.5 690.7676h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m914.5 141.1094h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m914.5 1082.873h10v14h-10z" fill="#fff" stroke="#181818"/><path d="m1042 285.3516h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m10 500.9043h860v75.9316h-860z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m10 864.0098h749v60.6211h-749z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m58 67.4883v1047.3847" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m702 67.4883v1047.3847" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m809 67.4883v1047.3847" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m919 67.4883v1047.3847" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1047 67.4883v1047.3847" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="76" x="20" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="27" y="56.5352">Validator</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="76" x="20" y="1113.873"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="27" y="1134.4082">Validator</text><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="655" y="64.5352">Subtree Data</text><ellipse cx="702" cy="35" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m690 49h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="655" y="1127.4082">Subtree Data</text><ellipse cx="702" cy="1146.3613" fill="#e2e2f0" rx="12" ry="12" stroke="#181818" stroke-width=".5"/><path d="m690 1160.3613h24" stroke="#181818" stroke-width=".5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="759" y="64.5352">Tx Meta Store</text><path d="m791.5 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m791.5 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="759" y="1127.4082">Tx Meta Store</text><path d="m791.5 1140.3613c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m791.5 1140.3613c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="870" y="64.5352">Subtree Store</text><path d="m901.5 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m901.5 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="870" y="1127.4082">Subtree Store</text><path d="m901.5 1140.3613c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m901.5 1140.3613c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="136" x="979" y="36"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="986" y="56.5352">Util HTTP Request</text><rect fill="#e2e2f0" height="30.4883" rx="2.5" stroke="#181818" stroke-width=".5" width="136" x="979" y="1113.873"/><text font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="986" y="1134.4082">Util HTTP Request</text><g stroke="#181818"><path d="m53 106.7988h10v990.0742h-10z" fill="#fff"/><path d="m58 251.041h10v63.6211h-10z" fill="#fff"/><path d="m58 480.9043h10v102.9316h-10z" fill="#fff"/><path d="m58 656.457h10v63.6211h-10z" fill="#fff"/><path d="m804.5 480.9043h10v102.9316h-10z" fill="#fff"/><path d="m804.5 690.7676h10v29.3105h-10z" fill="#fff"/><path d="m914.5 141.1094h10v29.3105h-10z" fill="#fff"/><path d="m914.5 1082.873h10v14h-10z" fill="#fff"/><path d="m1042 285.3516h10v29.3105h-10z" fill="#fff"/><path d="m58 93.7988h47"/><path d="m105 93.7988v13"/><path d="m64 106.7988h41"/><path d="m74 102.7988-10 4 10 4-4-4z" fill="#181818"/></g><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="70" y="89.0566">validateSubtreeInternal(ctx, validateSubtree)</text><path d="m902.5 137.1094 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m63 141.1094h845.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280" x="70" y="136.3672">subtreeStore.Exists(spanCtx, subtreeHash[:])</text><path d="m74 166.4199-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m68 170.4199h850.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="80" y="165.6777">subtreeExists / err</text><path d="m0 199.0752h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 199.0752h1120" stroke="#000"/><path d="m0 202.0752h1120" stroke="#000"/><path d="m395.5 188.4199h329v23.3105h-329z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="307" x="401.5" y="204.9883">Get the Subtree from the remote Asset Server</text><path d="m63 238.041h47" stroke="#181818"/><path d="m110 238.041v13" stroke="#181818"/><path d="m69 251.041h41" stroke="#181818"/><path d="m79 247.041-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331" x="75" y="233.2988">getSubtreeTxHashes(ctx, stat, subtreeHash, baseUrl)</text><path d="m1030 281.3516 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m68 285.3516h968" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="75" y="280.6094">DoHTTPRequestBodyReader(spanCtx, url)</text><path d="m74 310.6621-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m68 314.6621h978" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="80" y="309.9199">subtree / err</text><path d="m0 343.3174h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 343.3174h1120" stroke="#000"/><path d="m0 346.3174h1120" stroke="#000"/><path d="m384 332.6621h352v23.3105h-352z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="330" x="390" y="349.2305">Create a subtree metadata (a decorated subtree)</text><path d="m63 387.2832h42" stroke="#181818"/><path d="m105 387.2832v13" stroke="#181818"/><path d="m64 400.2832h41" stroke="#181818"/><path d="m74 396.2832-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="70" y="382.541">Create a subtreeMeta from the subtree</text><path d="m0 428.9385h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 428.9385h1120" stroke="#000"/><path d="m0 431.9385h1120" stroke="#000"/><path d="m287 418.2832h546v23.3105h-546z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="524" x="293" y="434.8516">Attempt to obtain the Tx Metadata for all txs through the existing meta cache</text><path d="m63 467.9043h47" stroke="#181818"/><path d="m110 467.9043v13" stroke="#181818"/><path d="m69 480.9043h41" stroke="#181818"/><path d="m79 476.9043-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398" x="75" y="463.1621">processTxMetaUsingCache(ctx, txHashes, txMetaSlice, failFast)</text><path d="m10 500.9043h74v7.3105l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 500.9043h860v75.9316h-860z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="25" y="514.4727">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="177" x="99" y="513.5391">[for each txHash in the subtree]</text><path d="m792.5 535.5254 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m68 539.5254h730.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276" x="75" y="534.7832">txMetaStore.GetMetaCached(gCtx, &amp;txHash)</text><path d="m79 564.8359-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m73 568.8359h730.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="85" y="564.0938">txMeta / err</text><path d="m0 604.4912h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 604.4912h1120" stroke="#000"/><path d="m0 607.4912h1120" stroke="#000"/><path d="m293 593.8359h534v23.3105h-534z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="512" x="299" y="610.4043">For any Tx Metadata not found in the cache, obtain it directly from the store</text><path d="m63 643.457h47" stroke="#181818"/><path d="m110 643.457v13" stroke="#181818"/><path d="m69 656.457h41" stroke="#181818"/><path d="m79 652.457-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="392" x="75" y="638.7148">processTxMetaUsingStore(ctx, txHashes, txMetaSlice, failFast)</text><path d="m792.5 686.7676 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m68 690.7676h730.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299" x="75" y="686.0254">txMetaStore.MetaBatchDecorate(gCtx, &amp;txHash)</text><path d="m74 716.0781-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m68 720.0781h740.5" stroke="#181818" stroke-dasharray="2 2"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="80" y="715.3359">txMeta / err</text><path d="m0 748.7334h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 748.7334h1120" stroke="#000"/><path d="m0 751.7334h1120" stroke="#000"/><path d="m294.5 738.0781h531v23.3105h-531z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="513" x="300.5" y="754.6465">If a transaction is unknown by the node, do request it from the remote node</text><path d="m63 792.6992h42" stroke="#181818"/><path d="m105 792.6992v13" stroke="#181818"/><path d="m64 805.6992h41" stroke="#181818"/><path d="m74 801.6992-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="620" x="70" y="787.957">processMissingTransactions(ctx, subtreeHash, missingTxHashesCompacted, baseUrl, txMetaSlice)</text><path d="m0 834.3545h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 834.3545h1120" stroke="#000"/><path d="m0 837.3545h1120" stroke="#000"/><path d="m349 823.6992h422v23.3105h-422z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="404" x="355" y="840.2676">Add all decorated (with tx meta) transactions to the subtree</text><path d="m10 864.0098h74v7.3105l-10 10h-64z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 864.0098h749v60.6211h-749z" fill="none" stroke="#000" stroke-width="1.5"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="25" y="877.5781">loop</text><text font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="149" x="99" y="876.6445">[for each tx in the subtree]</text><path d="m690 898.6309 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m63 902.6309h633" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="500" x="70" y="897.8887">Add transaction to Subtree - AddNode(txHash, txMeta.Fee, txMeta.SizeInBytes)</text><path d="m74 912.6309-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m68 916.6309h633" stroke="#181818" stroke-dasharray="2 2"/><path d="m0 952.2861h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 952.2861h1120" stroke="#000"/><path d="m0 955.2861h1120" stroke="#000"/><path d="m402.5 941.6309h315v23.3105h-315z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="297" x="408.5" y="958.1992">Add meta data required for block validation</text><path d="m690 992.252 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m63 996.252h633" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351" x="70" y="991.5098">SetParentTxHashes(subtreeIdx, txMeta.ParentTxHashes)</text><path d="m74 1006.252-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m68 1010.252h633" stroke="#181818" stroke-dasharray="2 2"/><path d="m0 1038.9072h1120v3h-1120z" fill="#eee" stroke="#eee"/><path d="m0 1038.9072h1120" stroke="#000"/><path d="m0 1041.9072h1120" stroke="#000"/><path d="m451.5 1028.252h217v23.3105h-217z" fill="#eee" stroke="#000" stroke-width="2"/><text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="199" x="457.5" y="1044.8203">Persist the decorated subtree</text><path d="m902.5 1078.873 10 4-10 4 4-4z" fill="#181818" stroke="#181818"/><path d="m63 1082.873h845.5" stroke="#181818"/><text font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="317" x="70" y="1078.1309">Set(spanCtx, merkleRoot[:], completeSubtreeBytes)</text><path d="m69 1092.873-10 4 10 4-4-4z" fill="#181818" stroke="#181818"/><path d="m63 1096.873h855.5" stroke="#181818" stroke-dasharray="2 2"/><text fill="#888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="167" y="1187.0293">Last Modified On: 19-March-2024</text></svg>
