@startuml PropagationBlaster Worker Function
skinparam backgroundColor #F0F8FF
skinparam defaultFontColor #333333
skinparam arrowColor #666666

' Define borders for all elements
skinparam entity {
  BorderColor #666666
  BackgroundColor #DDDDDD
}

skinparam control {
  BorderColor #666666
  BackgroundColor #DDDDDD
}

skinparam participant {
  BorderColor #666666
  BackgroundColor #DDDDDD
}



participant "Worker" as Worker
participant "Propagation\nService" as Propagation

== Worker Loop ==
loop Each Transaction
    Worker -> Worker: Generate new transaction

    Worker -> Worker: Sign transaction

    alt Broadcast Protocol is Stream
        Worker -> Propagation: ProcessTransaction(tx.ExtendedBytes())

    else Broadcast Protocol is HTTP
        Worker -> Propagation: sendToPropagationServer(ctx, logger, tx.ExtendedBytes());
        Propagation --> Worker: HTTP response

    else Broadcast Protocol is gRPC
        Worker -> Propagation: sendToPropagationServer(ctx, logger, tx.ExtendedBytes());
        Propagation --> Worker: gRPC response

    end
end

left footer Last Modified On: %date("dd-MMM-yyyy")

@enduml
