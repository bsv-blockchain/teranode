<svg contentStyleType="text/css" height="928" preserveAspectRatio="none" viewBox="0 0 1312 928" width="1312" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify"><path d="m0 0h1312v928h-1312z" fill="#f0f8ff"/><g fill="#fff"><path d="m58.1895 219.3516h10v29.3105h-10z" stroke="#181818"/><path d="m58.1895 302.2832h10v29.3105h-10z" stroke="#181818"/><path d="m415.7207 83.1094h10v35.3105h-10z" stroke="#181818"/><path d="m614.8779 190.041h10v669.5215h-10z" stroke="#181818"/><path d="m619.8779 685.0098h10v124.2422h-10z" stroke="#181818"/><path d="m840.8691 427.5254h10v29.3105h-10z" stroke="#181818"/><path d="m949.1016 576.0781h10v64.6211h-10z" stroke="#181818"/></g><path d="m10 263.6621h1296.6025v582.9004h-1296.6025z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m548.5903 388.9043h359.748v75.9316h-359.748z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m548.5903 537.457h748.0122v111.2422h-748.0122z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m548.5903 705.0098h359.748v75.9316h-359.748z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m63 36.4883v841.0742" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m420.2969 36.4883v841.0742" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m619.5903 36.4883v841.0742" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m845.3999 36.4883v841.0742" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><path d="m953.3384 36.4883v841.0742" stroke="#181818" stroke-dasharray="5 5" stroke-width=".5"/><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="86.3789" x="20" y="5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.3789" x="27" y="25.5352">Blockchain</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="86.3789" x="20" y="876.5625"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.3789" x="27" y="897.0977">Blockchain</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="168.8477" x="336.2969" y="5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154.8477" x="343.2969" y="25.5352">Block Validation Server</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="168.8477" x="336.2969" y="876.5625"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154.8477" x="343.2969" y="897.0977">Block Validation Server</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="122.5752" x="558.5903" y="5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.5752" x="565.5903" y="25.5352">Block Validation</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="122.5752" x="558.5903" y="876.5625"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.5752" x="565.5903" y="897.0977">Block Validation</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="104.9385" x="793.3999" y="5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.9385" x="800.3999" y="25.5352">Subtree Store</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="104.9385" x="793.3999" y="876.5625"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.9385" x="800.3999" y="897.0977">Subtree Store</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="91.5264" x="908.3384" y="5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.5264" x="915.3384" y="25.5352">UTXO Store</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="91.5264" x="908.3384" y="876.5625"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.5264" x="915.3384" y="897.0977">UTXO Store</text><path d="m58.1895 219.3516h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m58.1895 302.2832h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m415.7207 83.1094h10v35.3105h-10z" fill="#fff" stroke="#181818"/><path d="m614.8779 190.041h10v669.5215h-10z" fill="#fff" stroke="#181818"/><path d="m619.8779 685.0098h10v124.2422h-10z" fill="#fff" stroke="#181818"/><path d="m840.8691 427.5254h10v29.3105h-10z" fill="#fff" stroke="#181818"/><path d="m949.1016 576.0781h10v64.6211h-10z" fill="#fff" stroke="#181818"/><path d="m403.7207 79.1094 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m63.1895 83.1094h346.5312" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="329.418" x="70.1895" y="63.0566">SendNotification(NotificationType_BlockSubtreesSet,</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.8384" x="70.1895" y="78.3672">blockHashBytes)</text><path d="m425.7207 117.4199h42" stroke="#666"/><path d="m467.7207 117.4199v13" stroke="#666"/><path d="m420.7207 130.4199h47" stroke="#666"/><path d="m430.7207 126.4199-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.4805" x="432.7207" y="112.6777">Enqueue to setMinedChan</text><path d="m425 138.4199v25h321v-15l-10-10z" fill="#feffdd" stroke="#181818" stroke-width=".5"/><path d="m736 138.4199v10h10z" fill="#feffdd" stroke="#181818" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300.3774" x="431" y="155.9883">Background goroutine processes setMinedChan</text><path d="m602.8779 186.041 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m420.7207 190.041h188.1572" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.1572" x="427.7207" y="185.2988">setTxMined(ctx, blockHash)</text><path d="m79.1895 215.3516-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m73.1895 219.3516h540.6884" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.6543" x="85.1895" y="214.6094">GetBlockExists(ctx, blockHash)</text><path d="m602.8779 244.6621 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m63.1895 248.6621h545.6884" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.2515" x="70.1895" y="243.9199">exists / not exists</text><path d="m10 263.6621h62.1387v7.3106l-10 10h-52.1387z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 263.6621h1296.6025v582.9004h-1296.6025z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="25" y="277.2305">alt</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="122.2622" x="87.1387" y="276.2969">[Block does not exist]</text><path d="m79.1895 298.2832-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m73.1895 302.2832h540.6884" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.7617" x="85.1895" y="297.541">GetBlock(ctx, blockHash)</text><path d="m602.8779 327.5938 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m63.1895 331.5938h545.6884" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.4775" x="70.1895" y="326.8516">Block</text><path d="m624.8779 360.9043h42" stroke="#666"/><path d="m666.8779 360.9043v13" stroke="#666"/><path d="m625.8779 373.9043h41" stroke="#666"/><path d="m635.8779 369.9043-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.96" x="631.8779" y="356.1621">Ensure all subtrees are loaded</text><path d="m548.5903 388.9043h74.4468v7.3105l-10 10h-64.4468z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m548.5903 388.9043h359.748v75.9316h-359.748z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="563.5903" y="402.4727">loop</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="202.3345" x="638.0371" y="401.5391">[for each subtree hash in the block]</text><path d="m828.8691 423.5254 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m624.8779 427.5254h209.9912" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.646" x="631.8779" y="422.7832">Get(ctx, subtreeHash)</text><path d="m635.8779 452.8359-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m629.8779 456.8359h214.9912" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.9185" x="641.8779" y="452.0938">Subtree</text><path d="m74.1895 489.1465-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m68.1895 493.1465h545.6884" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.0371" x="80.1895" y="488.4043">GetBlockHeaderIDs(ctx, blockHash, 1)</text><path d="m602.8779 518.457 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m63.1895 522.457h545.6884" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.6646" x="70.1895" y="517.7148">blockID</text><path d="m548.5903 537.457h74.4468v7.3106l-10 10h-64.4468z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m548.5903 537.457h748.0122v111.2422h-748.0122z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="563.5903" y="551.0254">loop</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="285.9302" x="638.0371" y="550.0918">[for each batch of tx hashes in the block subtrees]</text><path d="m937.1016 572.0781 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m624.8779 576.0781h318.2237" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.6411" x="631.8779" y="571.3359">SetMinedMulti(ctx, txBatchHashes, blockID)</text><path d="m964 589.0781v40h322v-30l-10-10z" fill="#feffdd" stroke="#181818" stroke-width=".5"/><path d="m1276 589.0781v10h10z" fill="#feffdd" stroke="#181818" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.6025" x="970" y="606.6465">SetMinedMulti also unsets the unspendable flag</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.9585" x="970" y="621.957">(second phase of two-phase commit)</text><path d="m635.8779 636.6992-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m629.8779 640.6992h323.2237" stroke="#666" stroke-dasharray="2 2"/><path d="m624.8779 672.0098h47" stroke="#666"/><path d="m671.8779 672.0098v13" stroke="#666"/><path d="m630.8779 685.0098h41" stroke="#666"/><path d="m640.8779 681.0098-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.9912" x="636.8779" y="667.2676">updateSubtreesTTL(ctx, block)</text><path d="m548.5903 705.0098h74.4468v7.3105l-10 10h-64.4468z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m548.5903 705.0098h359.748v75.9316h-359.748z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="563.5903" y="718.5781">loop</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171.2788" x="638.0371" y="717.6445">[for each Subtree in the Block]</text><path d="m833.8691 739.6309 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m629.8779 743.6309h209.9912" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.0718" x="636.8779" y="738.8887">SetTTL(ctx, subtreeHash, 0)</text><path d="m640.8779 768.9414-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m634.8779 772.9414h209.9912" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.5117" x="646.8779" y="768.1992">TTL set to 0</text><path d="m74.1895 805.252-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m68.1895 809.252h545.6884" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.0205" x="80.1895" y="804.5098">SetBlockSubtreesSet(ctx, blockHash)</text><path d="m74.1895 834.5625-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m68.1895 838.5625h545.6884" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.9229" x="80.1895" y="833.8203">SetBlockMinedSet(ctx, blockHash)</text><path d="m431.7207 855.5625-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m425.7207 859.5625h193.1572" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="155.4932" y="918.7188">Last Modified On: 12-Apr-2025</text></svg>
