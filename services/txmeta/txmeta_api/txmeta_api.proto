syntax = "proto3";

option go_package = ".;txmeta_api";

package txmeta_api;

import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";

service TxMetaAPI {
  // Health returns the health of the API.
  rpc HealthGRPC (google.protobuf.Empty) returns (HealthResponse) {}
  rpc Create (CreateRequest) returns (CreateResponse) {}
  rpc SetMined (SetMinedRequest) returns (SetMinedResponse) {}
  rpc Get (GetRequest) returns (GetResponse) {}
  rpc Delete (DeleteRequest) returns (DeleteResponse) {}
}

// swagger:model HealthResponse
message HealthResponse {
  bool ok = 1;
  string details = 2;
  google.protobuf.Timestamp timestamp = 3;
}

// swagger:enum Status
enum Status {
  // StatusUnknown is the default status.
  StatusUnknown = 0;
  // StatusUnconfirmed is the status of a transaction that has not been mined.
  StatusUnconfirmed = 1;
  // StatusConfirmed is the status of a transaction that has been mined.
  StatusConfirmed = 2;
}

// swagger:model SetRequest
message CreateRequest {
  bytes tx = 1;
  bytes hash = 2;
  uint64 fee = 3;
  repeated bytes ParentTxHashes = 4;
  uint32 lockTime = 5;
  uint64 sizeInBytes = 6;
}

// swagger:model SetResponse
message CreateResponse {
  Status status = 1;
}

// swagger:model SetMinedRequest
message SetMinedRequest {
  bytes hash = 1;
  uint32 block_id = 2;
}

// swagger:model SetMinedResponse
message SetMinedResponse {
  Status status = 1;
}

// swagger:model GetRequest
message GetRequest {
  bytes hash = 1;
}

// swagger:model GetResponse
message GetResponse {
  Status status = 1;
  uint64 Fee = 2;
  repeated bytes ParentTxHashes = 3;
  uint32 FirstSeen = 4;
  repeated uint32 BlockIDs = 5;
  uint32 BlockHeight = 6;
  uint64 SizeInBytes = 7;
}

// swagger:model DeleteRequest
message DeleteRequest {
  bytes hash = 1;
}

// swagger:model DeleteResponse
message DeleteResponse {
  Status status = 1;
}
